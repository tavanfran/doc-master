<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: Funnel-Metadynamics (FM)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.7.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_u_n_n_e_l.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Funnel-Metadynamics (FM) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<p>FM is a combination of Metadynamics bias potential <a class="el" href="citelist.html#CITEREF_metad">[64]</a> with a funnel-shape restraint potential applied to the target structure of a binding interaction. The latter is composed of a cone restraint, which covers the ligand binding site, and a cylindrical one that heads towards the solvent <b>[FM]</b>. When inside the funnel volume, the ligand does not feel any restraint potential, proceeding as regular Metadynamics. Upon reaching the boundaries of the funnel, a repulsive bias is applied forcing the ligand to remain in the allowed funnel space. The result is an acceleration in the sampling of the binding/unbinding process, leading to a swift convergence of the calculation and a well-defined binding free-energy surface.</p>
<h2>Installation</h2>
<p>This module is not installed by default. Add '--enable-modules=funnel' to your './configure' command when building PLUMED to enable these features.</p>
<h2>Usage</h2>
<p>This module is a direct evolution of the original FM <b>[FM]</b> since it incorporates an alignment function that removes the necessity to block the target macromolecule in the simulation box.</p>
<p>The user can follow a comprehensive protocol <b>[FM-protocol]</b>, which will help in all stages of the simulation, including pre- and post-processing. An example of input file can be found on <a href="https://www.plumed-nest.org/eggs/19/039/">FUNNEL-NEST's webpage</a></p>
<h2>Module Contents</h2>
<p>The funnel module is composed of a collective variable that calculates the position of a ligand with respect to a line and a potential that creates a funnel-shape restraint centered on the line (<a class="el" href="_f_u_n_n_e_l__p_s.html">FUNNEL_PS</a> and <a class="el" href="_f_u_n_n_e_l.html">Funnel-Metadynamics (FM)</a>, respectively).</p>
<ul>
<li><a class="el" href="funnel_cv.html">CV documentation</a></li>
<li><a class="el" href="funnel_bias.html">Bias Documentation</a></li>
</ul>
<table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="60%%"></td><td><b> This is part of the funnel <a class="el" href="mymodules.html">module </a></b>   </td></tr>
<tr>
<td width="60%%"></td><td><b> It is only available if you configure PLUMED with ./configure &ndash;enable-modules=funnel . Furthermore, this feature is still being developed so take care when using it and report any problems on the mailing list.</b>   </td></tr>
</table>
<p>Calculate a funnel-shape restraint potential that is defined on a grid that is read during the setup. If the input file is not already present, it will create one with the name specified in the FILE flag. The potential has a two-dimensional resolution since it has been devised to be used with the two components of <a class="el" href="_f_u_n_n_e_l__p_s.html">FUNNEL_PS</a> (i.e., fps.lp and fps.ld) and it is divided in two sections, a cone shape attached to a cylindrical one. The user can customize the shape of both the sections by modifying a number of flags. In particular the cone section of the funnel is calculated with the following formula:</p>
<p class="formulaDsp">
\[ MAX_Z=R_{cyl} + tg_{alpha} * (z_{cc} - MIN_S) \]
</p>
<p>where \( MAX_Z \) is the radius of the cone base, \( R_{cyl} \) is the radius of the cylinder part, \( tg_{alpha} \) is the angle regulating how steep the cone is, \( z_{cc} \) is the switching point between cone and cylinder, and \( MIN_S \) is the lowest possible value assumed by fps.lp of <a class="el" href="_f_u_n_n_e_l__p_s.html">FUNNEL_PS</a>. As for the cylinder, it starts from the value of \( z_{cc} \) and stops at the value of \( MAX_S \) with a section of \( pi*r_{cyl}^2 \).</p>
<p>There is the option of transforming the cone region into a sphere with the use of the SPHERE flag. In this case, the new shape will have a radius of \( z_{cc} \). It might be necessary tuning the SAFETY option to select how much the potential extends from the sphere.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quantities can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> SCALE </b> </td><td>( default=1.0 ) a factor that multiplies the external potential, useful to invert free energies   </td></tr>
<tr>
<td width="15%"><b> MAXS </b> </td><td>( default=MAXS ) maximum value assumed by fps.lp   </td></tr>
<tr>
<td width="15%"><b> ZCC </b> </td><td>( default=ZCC ) switching point between cylinder and cone   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>name of the Funnel potential file   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOSPLINE </b> </td><td>( default=off ) specifies that no spline interpolation is to be used when calculating the energy and forces due to the external potential   </td></tr>
<tr>
<td width="15%"><b> SPARSE </b> </td><td>( default=off ) specifies that the external potential uses a sparse grid   </td></tr>
<tr>
<td width="15%"><b> SPHERE </b> </td><td>( default=off ) The Funnel potential including the binding site can be spherical instead of a cone   </td></tr>
<tr>
<td width="15%"><b> WALKERS_MPI </b> </td><td><p class="starttd">( default=off ) To be used when gromacs + multiple walkers are used  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td>the input for this action is the scalar output from one or more other actions. The particular scalars that you will use are referenced using the label of the action. If the label appears on its own then it is assumed that the Action calculates a single scalar value. The value of this scalar is thus used as the input to this new action. If * or *.* appears the scalars calculated by all the proceeding actions in the input file are taken. Some actions have multi-component outputs and each component of the output has a specific label. For example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> action labelled dist may have three components x, y and z. To take just the x component you should use dist.x, if you wish to take all three components then use dist.*.More information on the referencing of Actions can be found in the section of the manual on the PLUMED <a class="el" href="_syntax.html">Getting Started</a>. Scalar values can also be referenced using POSIX regular expressions as detailed in the section on <a class="el" href="_regex.html">Regular Expressions</a>. To use this feature you you must compile PLUMED with the appropriate flag. You can use multiple instances of this keyword i.e. ARG1, ARG2, ARG3...   </td></tr>
<tr>
<td width="15%"><b> NBINS </b> </td><td>number of bins along fps.lp   </td></tr>
<tr>
<td width="15%"><b> NBINZ </b> </td><td>number of bins along fps.ld   </td></tr>
<tr>
<td width="15%"><b> MINS </b> </td><td>minimum value assumed by fps.lp, if the ligand is able to go beyond this value the simulation will crash   </td></tr>
<tr>
<td width="15%"><b> KAPPA </b> </td><td>constant to be used for the funnel-shape restraint potential   </td></tr>
<tr>
<td width="15%"><b> RCYL </b> </td><td>radius of the cylindrical section   </td></tr>
<tr>
<td width="15%"><b> SAFETY </b> </td><td>To be used in case the SPHERE flag is chosen, it regulates how much the potential extends (in nm)   </td></tr>
<tr>
<td width="15%"><b> SLOPE </b> </td><td>Adjust the behavior of the potential outside the funnel, greater values than 1.0 will tend to push the ligand more towards the cylinder and vice versa   </td></tr>
<tr>
<td width="15%"><b> ALPHA </b> </td><td>angle to change the width of the cone section   </td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following is an input for a calculation with a funnel potential that is defined in the file BIAS and that acts on the collective variables defined by FUNNEL_PS. </p><pre class="fragment">
lig: <a href="./_c_o_m.html" style="color:green">COM</a> ATOMS=3221,3224,3225,3228,3229,3231,3233,3235,3237
fps: <a href="./_f_u_n_n_e_l__p_s.html" style="color:green">FUNNEL_PS</a> LIGAND=lig REFERENCE=start.pdb ANCHOR=2472 POINTS=4.724,5.369,4.069,4.597,5.721,4.343

<a href="./_f_u_n_n_e_l.html" style="color:green">FUNNEL</a> ARG=fps.lp,fps.ld ZCC=1.8 ALPHA=0.55 RCYL=0.1 MINS=-0.5 MAXS=3.7 KAPPA=35100 NBINS=500 NBINZ=500 FILE=BIAS LABEL=funnel
</pre><p>The BIAS will then look something like this: </p><pre class="fragment">#! FIELDS fps.lp fps.ld funnel.bias der_fps.lp der_fps.ld
#! SET min_fps.lp -0.500000
#! SET max_fps.lp 3.700000
#! SET nbins_fps.lp 500.000000
#! SET periodic_fps.lp false
#! SET min_fps.ld 0.000000
#! SET max_fps.ld 1.510142
#! SET nbins_fps.ld 500.000000
#! SET periodic_fps.ld false
    -0.500000      0.000000      0.000000      0.000000      0.000000
    -0.500000      0.003020      0.000000      0.000000      0.000000
    -0.500000      0.006041      0.000000      0.000000      0.000000
    -0.500000      0.009061      0.000000      0.000000      0.000000
    -0.500000      0.012081      0.000000      0.000000      0.000000
    -0.500000      0.015101      0.000000      0.000000      0.000000
</pre><p>The Funnel potential should always be used in combination with the collective variable <a class="el" href="_f_u_n_n_e_l__p_s.html">FUNNEL_PS</a>, since it is constructed to take as inputs fps.lp and fps.ld (the former linepos and linedist of Funnel-Metadynamics <b>[FM]</b>). In the first block of data the value of fps.lp (the value in the first column) is kept fixed and the value of the function is given at 500 equally spaced values for fps.ld between 0 and 1.51. In the second block of data fps.lp is fixed at \(-0.5 + \frac{4.2}{500}\) and the value of the function is given at 500 equally spaced values for fps.ld between 0 and 1.51. In the third block of data the same is done but fps.lp is fixed at \(-0.5 + \frac{8.4}{100}\) and so on until you get to the five hundredth block of data where fps.lp is fixed at \(3.7\).</p>
<p>It is possible to switch the shape of the cone region, transforming it in a sphere, with the flag SPHERE. </p><pre class="fragment">
lig: <a href="./_c_o_m.html" style="color:green">COM</a> ATOMS=545,546,547,548,549,550,551,552,553
fps: <a href="./_f_u_n_n_e_l__p_s.html" style="color:green">FUNNEL_PS</a> LIGAND=lig REFERENCE=ref.pdb ANCHOR=52 POINTS=2.793,3.696,3.942,3.607,4.298,3.452

<a href="./_f_u_n_n_e_l.html" style="color:green">FUNNEL</a> ARG=fps.lp,fps.ld ZCC=4.0 RCYL=0.1 MINS=0.2 MAXS=4.9 KAPPA=100000 NBINS=500 NBINZ=500 SPHERE SAFETY=1.0 FILE=BIAS LABEL=funnel
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_bias.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
